@model Frisbeeboys.Web.Models.PageModel<Frisbeeboys.Web.Controllers.Scorecards.Models.ScorecardModel>

<h1 class="text-lg">Scorecards</h1>

@foreach (var scorecard in Model.Data)
{
    <div class="mb-4 shadow-md max-w-2xl">
        <div class="bg-white p-5">
            <div class="font-semibold">@scorecard.CourseName</div>
            <div class="text-gray-500">@scorecard.LayoutName</div>
            <table class="mt-3">
                <tr>
                    <td class="text-right text-xs">HOLE</td>
                    @foreach (var i in Enumerable.Range(1, scorecard.HolePars.Length))
                    {
                        <td class="font-semibold text-center p-1">@i</td>
                    }
                    <td class="font-semibold text-center pl-2">TOT</td>
                    <td class="font-semibold text-center pl-2">+/-</td>
                </tr>
                <tr class="border-b-2">
                    <td class="text-right text-xs">PAR</td>
                    @foreach (var par in scorecard.HolePars)
                    {
                        <td class="text-center p-1">@par</td>
                    }
                    <td class="text-center">@scorecard.HolePars.Sum()</td>
                    <td></td>
                </tr>
                @foreach (var player in scorecard.Players)
                {
                    <tr class="mb-2">
                        <td class="pb-1">@player.Name</td>
                        @for (var i = 0; i < player.HoleScores.Length; i++)
                        {
                            var score = player.HoleScores[i];
                            var c = "";
                            if (score == 1)
                            {
                                // Ace
                                c = "bg-blue-900 text-white";
                            }
                            else if (score > scorecard.HolePars[i])
                            {
                                // Bogey
                                var intensity = 100 + (score - scorecard.HolePars[i]) * 100;
                                c = "bg-yellow-" + intensity;
                            }
                            else if (score < scorecard.HolePars[i])
                            {
                                // Birdie
                                var intensity = 300 + (scorecard.HolePars[i] - score) * 100;
                                c = $"bg-blue-{intensity} text-white";
                            }

                            <td class="text-center p-1 @c">@player.HoleScores[i]</td> 
                        }
                        <td class="text-center">@player.Total</td>
                        <td class="text-center">
                            @(player.Par switch {
                                0 => "E",
                                >0 => "+" + player.Par,
                                _ => player.Par
                                })
                        </td>
                    </tr>
                }
            </table>
        </div>
        <div class="bg-yellow-600 text-white p-2">
            <div class="font-semibold text-sm">@scorecard.Date.ToString("g")</div>
        </div>
    </div>
}
